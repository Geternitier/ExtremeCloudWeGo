# 优化文档

## 问题描述

在API网关的测试过程中，我们发现系统存在以下问题：

- 响应时间较长，平均响应时间超过40ms。
- 在高并发情况下，虽然未表现出错误情况，但是系统容易出现错误请求。
- 系统负载较高，CPU和内存使用率较高。

## 优化方案

为了解决以上问题，我们制定了以下的优化方案：

### 1. 优化Update

- 此前每次调用查询或登记服务时，都需要先获取最新IDL
- 将IDL更新改为固定时间间隔更新，与调用服务无关

### 2. 添加锁的实现

- 为存储数据的map调用添加锁

### 3. 优化泛化调用

- 此前每次JSON泛化调用都需要单独产生一个泛化调用Client
- 修改后，将使用单例的泛化调用Client
